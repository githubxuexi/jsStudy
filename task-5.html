<!Doctype>
<html>
   <head>
   	 <title>
        
   	 	   这是以老师更改手机号通知学生为例子写的观察者模式
   	 </title>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
   	 <script>
   	   
   	    
        function Publisher()
        {
        	 
         	 this.phone;
        	 this.Arraylist=new Array();

        }
        Publisher.prototype.sayPhone=function()
        {
        	return this.phone;
        }
        Publisher.prototype.registerSubscriber=function(o)
        {
           this.Arraylist.push(o);

        }
        Publisher.prototype.removeSubscriber=function(o)
        {
           var j=0;
           for(var i=0;i<this.Arraylist.length;i++)
           {
              if(this.Arraylist[i]==o)
              	j=i;
              	break;
           }
           for (var i=j;i<this.Arraylist.length-1;i++)
           {
           	 this.Arraylist[i]=this.Arraylist[i+1];
           }
        }
        Publisher.prototype.notifySubscriber=function(phone)
        {
        	for(var i=0;i<this.Arraylist.length;i++)
        	{
        		this.Arraylist[i].update(phone);
        	}
        
        }
        Publisher.prototype.setPhone=function(value)
        {
           this.phone=value;
           this.notifySubscriber(this.phone);
        }


        function Subscriber(name)
       
        {
        	this.name=name;
        	this.tphone;
        }
        Subscriber.prototype.update=function(o)
        {
           this.tphone=o;
        }
        Subscriber.prototype.show=function()
        {
        	document.write("student Name:")+document.write(this.name);
        	document.write("<br>");
        	document.write("The teacher Phone:   ")+document.write(this.tphone);
        }
        /*定义三个观察者*/
        var stu=new Subscriber("小明");
        var stu1=new Subscriber("小红");
        var stu2=new Subscriber("小丽");
        /*定义被观察者*/
        var tea=new Publisher();
        /*注册观察者*/
        tea.registerSubscriber(stu); 
        tea.registerSubscriber(stu1);
        tea.registerSubscriber(stu2);
        /*设置电话*/
        tea.setPhone("22222");
        /*展示*/
        stu.show();
        document.write("<br>");
        stu1.show();
        document.write("<br>");
        stu2.show();

        document.write("<br>");
        document.write("------------");
        document.write("<br>");
        /*移除小明观察者*/
        tea.removeSubscriber(stu);
        tea.removeSubscriber(stu1);
        /*老师再次更新电话*/
        tea.setPhone("21112222");
        /*展示*/
        stu.show();
        document.write("<br>");
        stu1.show();
        document.write("<br>");
        stu2.show();
   	 </script>

   </head>
   <body></body>
</html>